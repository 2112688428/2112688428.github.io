<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡´å»–èŠ³ç´çš„å¿ƒæ„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- é…ç½®Tailwindè‡ªå®šä¹‰é¢œè‰²å’Œå­—ä½“ -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        love: {
                            pink: '#FF6B9B',
                            purple: '#A77DC2',
                            blue: '#7EB6FF',
                            dark: '#2A2438'
                        }
                    },
                    fontFamily: {
                        romantic: ['"Dancing Script"', 'cursive', 'sans-serif'],
                        main: ['"Montserrat"', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <!-- è‡ªå®šä¹‰å·¥å…·ç±» -->
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            }
            .text-shadow-lg {
                text-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            }
            .animate-float {
                animation: float 6s ease-in-out infinite;
            }
            .backdrop-blur-xl {
                backdrop-filter: blur(24px);
            }
            .animate-shake {
                animation: shake 0.5s ease-in-out;
            }
            .animate-pulse-fast {
                animation: pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            }
            .animate-jump {
                animation: jump 0.5s ease-in-out;
            }
            .animate-spin-fast {
                animation: spin 0.5s linear;
            }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            75% { transform: translateX(5px) rotate(2deg); }
        }

        @keyframes jump {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>

    <!-- å¼•å…¥Googleå­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body class="font-main overflow-x-hidden bg-love-dark text-white min-h-screen">
<!-- ä»£ç é›¨èƒŒæ™¯ -->
<canvas id="matrix" class="fixed inset-0 z-0 opacity-60"></canvas>

<!-- ä¸»å®¹å™¨ -->
<div class="relative z-10 container mx-auto px-4 py-12 md:py-20">
    <!-- æ ‡é¢˜åŒºåŸŸ -->
    <header class="text-center mb-16 md:mb-24">
        <h1 class="font-romantic text-[clamp(2.5rem,8vw,5rem)] font-bold text-transparent bg-clip-text bg-gradient-to-r from-love-pink via-love-purple to-love-blue text-shadow-lg animate-float">
            è‡´å»–èŠ³ç´
        </h1>
        <p class="mt-6 text-[clamp(1rem,3vw,1.5rem)] text-gray-200 max-w-3xl mx-auto">
            æœ‰äº›è¯ï¼Œæˆ‘æƒ³äº†å¾ˆä¹…å¾ˆä¹…ï¼Œç°åœ¨ç»ˆäºæœ‰å‹‡æ°”å‘Šè¯‰ä½ ...
        </p>
    </header>

    <!-- å›¾ç‰‡è½®æ’­åŒºåŸŸ -->
    <section class="relative max-w-4xl mx-auto mb-20 overflow-hidden rounded-2xl shadow-2xl transform transition-all duration-500 hover:scale-[1.02]">
        <div id="carousel" class="flex transition-transform duration-700 ease-in-out h-[250px] md:h-[500px]">
            <!-- è½®æ’­å›¾ç‰‡ - ä½¿ç”¨picsumä½œä¸ºç¤ºä¾‹ï¼Œå®é™…ä½¿ç”¨æ—¶æ›¿æ¢ä¸ºçœŸå®å›¾ç‰‡ -->
            <div class="min-w-full h-full">
                <img src="https://picsum.photos/id/1024/800/500" alt="æµªæ¼«çš„é£æ™¯" class="w-full h-full object-cover">
            </div>
            <div class="min-w-full h-full">
                <img src="https://picsum.photos/id/1062/800/500" alt="ç¾ä¸½çš„èŠ±æœµ" class="w-full h-full object-cover">
            </div>
            <div class="min-w-full h-full">
                <img src="https://picsum.photos/id/1074/800/500" alt="å¤•é˜³ä¸‹çš„é£æ™¯" class="w-full h-full object-cover">
            </div>
            <div class="min-w-full h-full">
                <img src="https://picsum.photos/id/152/800/500" alt="æ˜Ÿç©º" class="w-full h-full object-cover">
            </div>
        </div>

        <!-- è½®æ’­æ§åˆ¶æŒ‰é’® -->
        <button id="prevBtn" class="absolute left-4 top-1/2 -translate-y-1/2 bg-black/30 hover:bg-black/50 backdrop-blur-xl p-3 rounded-full transition-all duration-300 hover:scale-110">
            <i class="fa fa-chevron-left text-xl"></i>
        </button>
        <button id="nextBtn" class="absolute right-4 top-1/2 -translate-y-1/2 bg-black/30 hover:bg-black/50 backdrop-blur-xl p-3 rounded-full transition-all duration-300 hover:scale-110">
            <i class="fa fa-chevron-right text-xl"></i>
        </button>

        <!-- è½®æ’­æŒ‡ç¤ºå™¨ -->
        <div class="absolute bottom-4 left-0 right-0 flex justify-center gap-2">
            <span class="carousel-indicator w-3 h-3 rounded-full bg-white/50 cursor-pointer transition-all duration-300 active"></span>
            <span class="carousel-indicator w-3 h-3 rounded-full bg-white/50 cursor-pointer transition-all duration-300"></span>
            <span class="carousel-indicator w-3 h-3 rounded-full bg-white/50 cursor-pointer transition-all duration-300"></span>
            <span class="carousel-indicator w-3 h-3 rounded-full bg-white/50 cursor-pointer transition-all duration-300"></span>
        </div>
    </section>

    <!-- è¡¨ç™½å†…å®¹åŒºåŸŸ -->
    <section class="max-w-3xl mx-auto bg-black/20 backdrop-blur-xl p-8 md:p-12 rounded-3xl shadow-xl border border-white/10 mb-16">
        <div class="space-y-6 md:space-y-8">
            <p class="text-lg md:text-xl leading-relaxed">
                èŠ³ç´ï¼Œä»æˆ‘ç¬¬ä¸€æ¬¡è§åˆ°ä½ çš„æ—¶å€™ï¼Œæˆ‘çš„ç›®å…‰å°±æ— æ³•ä»ä½ èº«ä¸Šç§»å¼€ã€‚ä½ çš„ç¬‘å®¹åƒé˜³å…‰ä¸€æ ·æ¸©æš–ï¼Œç…§äº®äº†æˆ‘æ‰€æœ‰çš„æ—¥å­ã€‚
            </p>
            <p class="text-lg md:text-xl leading-relaxed">
                æ¯æ¬¡å’Œä½ è¯´è¯ï¼Œæˆ‘çš„å¿ƒè·³éƒ½ä¼šåŠ é€Ÿï¼Œæˆ‘æ€»æ˜¯åœ¨æƒ³ï¼Œæ€ä¹ˆä¼šæœ‰è¿™ä¹ˆç¾å¥½çš„äººå­˜åœ¨ã€‚ä½ çš„å–„è‰¯ã€ä½ çš„èªæ…§ã€ä½ å¶å°”çš„å°è°ƒçš®ï¼Œéƒ½æ·±æ·±åœ°å¸å¼•ç€æˆ‘ã€‚
            </p>
            <p class="text-lg md:text-xl leading-relaxed">
                æˆ‘çŸ¥é“ï¼Œä¹Ÿè®¸ç°åœ¨è¯´è¿™äº›æœ‰äº›çªç„¶ï¼Œä½†æˆ‘å®åœ¨æ— æ³•å†éšè—æˆ‘çš„å¿ƒæ„ã€‚æˆ‘å–œæ¬¢ä½ ï¼Œå»–èŠ³ç´ï¼Œéå¸¸éå¸¸å–œæ¬¢ã€‚
            </p>
            <p class="text-lg md:text-xl leading-relaxed">
                æˆ‘å¸Œæœ›èƒ½æœ‰æœºä¼šï¼Œé™ªä½ çœ‹éä¸–é—´é£æ™¯ï¼Œåˆ†äº«ç”Ÿæ´»ä¸­çš„ç‚¹ç‚¹æ»´æ»´ã€‚ä½ æ„¿æ„ç»™æˆ‘è¿™ä¸ªæœºä¼šå—ï¼Ÿ
            </p>

            <div class="text-center mt-10">
                <p class="font-romantic text-3xl md:text-4xl text-love-pink">æˆ‘å–œæ¬¢ä½ </p>
            </div>
        </div>
    </section>

    <!-- äº’åŠ¨æŒ‰é’®åŒºåŸŸ -->
    <section class="max-w-md mx-auto flex flex-col sm:flex-row justify-center gap-6 mb-16">
        <button id="noBtn" class="px-6 py-5 bg-gray-700 hover:bg-gray-600 rounded-full text-lg font-medium transition-all duration-300 transform hover:scale-105 hover:shadow-lg relative min-w-[160px]">
            <span id="noBtnText">å†è€ƒè™‘ä¸€ä¸‹</span>
            <span id="noBtnEmoji" class="ml-2">ğŸ˜</span>
        </button>
        <button id="yesBtn" class="px-6 py-5 bg-gradient-to-r from-love-pink to-love-purple hover:opacity-90 rounded-full text-lg font-medium transition-all duration-300 transform hover:scale-105 hover:shadow-lg min-w-[160px]">
            æˆ‘æ„¿æ„
        </button>
    </section>

    <!-- è§¦æ‘¸æç¤ºï¼ˆä»…åœ¨ç§»åŠ¨è®¾å¤‡æ˜¾ç¤ºï¼‰ -->
    <div id="touchHint" class="hidden text-center text-gray-300 mb-10">
        <p><i class="fa fa-hand-pointer-o mr-2"></i> è¯•è¯•ç‚¹å‡»é‚£ä¸ªè°ƒçš®çš„æŒ‰é’®</p>
    </div>

    <!-- çˆ±å¿ƒåŠ¨ç”»åŒºåŸŸ -->
    <div id="heartsContainer" class="fixed inset-0 pointer-events-none z-20"></div>
</div>

<!-- é¡µè„š -->
<footer class="relative z-10 text-center text-gray-400 py-6">
    <p>ç”¨æˆ‘å…¨éƒ¨çš„å¿ƒæ„ â¤ï¸ åˆ¶ä½œ</p>
</footer>

<!-- æˆåŠŸå¼¹çª— -->
<div id="successModal" class="fixed inset-0 bg-black/80 backdrop-blur-xl z-50 flex items-center justify-center hidden">
    <div class="bg-gradient-to-br from-love-purple to-love-pink p-8 md:p-12 rounded-3xl max-w-md w-full mx-4 text-center transform transition-all duration-500 scale-95 opacity-0" id="modalContent">
        <div class="text-6xl mb-6">ğŸ‰</div>
        <h2 class="font-romantic text-3xl md:text-4xl mb-4">å¤ªå¥½äº†ï¼</h2>
        <p class="text-lg mb-8">æˆ‘ä¼šç”¨ä¸€ç”Ÿçš„æ—¶é—´æ¥è¯æ˜ï¼Œä½ åšäº†ä¸€ä¸ªæœ€æ­£ç¡®çš„å†³å®šã€‚</p>
        <button id="closeModal" class="bg-white text-love-purple px-6 py-3 rounded-full font-medium hover:bg-gray-100 transition-all duration-300">
            ç¡®å®š
        </button>
    </div>
</div>

<script>
    // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

    // ä»£ç é›¨æ•ˆæœ
    const canvas = document.getElementById('matrix');
    const ctx = canvas.getContext('2d');

    // è®¾ç½®canvaså°ºå¯¸
    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // ä»£ç é›¨å­—ç¬¦
    const chars = '01ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ãƒãƒ„ãƒ†ãƒˆãƒŠãƒ‹ãƒŒãƒãƒãƒãƒ’ãƒ•ãƒ˜ãƒ›ãƒãƒŸãƒ ãƒ¡ãƒ¢ãƒ¤ãƒ¦ãƒ¨ãƒ©ãƒªãƒ«ãƒ¬ãƒ­ãƒ¯ãƒ°ãƒ±ãƒ²ãƒ³ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const columns = Math.floor(canvas.width / 20);
    const drops = Array(columns).fill(1);

    function drawMatrix() {
        // åŠé€æ˜é»‘è‰²èƒŒæ™¯ï¼Œåˆ›å»ºæ‹–å°¾æ•ˆæœ
        ctx.fillStyle = 'rgba(42, 36, 56, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // è®¾ç½®æ–‡å­—é¢œè‰²å’Œå­—ä½“
        ctx.fillStyle = '#A77DC2';
        ctx.font = '15px monospace';

        for (let i = 0; i < drops.length; i++) {
            // éšæœºé€‰æ‹©å­—ç¬¦
            const text = chars[Math.floor(Math.random() * chars.length)];

            // ç»˜åˆ¶å­—ç¬¦
            ctx.fillText(text, i * 20, drops[i] * 20);

            // å½“å­—ç¬¦åˆ°è¾¾åº•éƒ¨æˆ–éšæœºé‡ç½®
            if (drops[i] * 20 > canvas.height && Math.random() > 0.975) {
                drops[i] = 0;
            }

            // ä¸‹é™
            drops[i]++;
        }
    }

    // å›¾ç‰‡è½®æ’­åŠŸèƒ½
    const carousel = document.getElementById('carousel');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const indicators = document.querySelectorAll('.carousel-indicator');
    let currentSlide = 0;
    const totalSlides = 4;

    function updateCarousel() {
        carousel.style.transform = `translateX(-${currentSlide * 100}%)`;

        // æ›´æ–°æŒ‡ç¤ºå™¨
        indicators.forEach((indicator, index) => {
            if (index === currentSlide) {
                indicator.classList.add('bg-love-pink', 'w-8');
                indicator.classList.remove('bg-white/50', 'w-3');
            } else {
                indicator.classList.remove('bg-love-pink', 'w-8');
                indicator.classList.add('bg-white/50', 'w-3');
            }
        });
    }

    prevBtn.addEventListener('click', () => {
        currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
        updateCarousel();
    });

    nextBtn.addEventListener('click', () => {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateCarousel();
    });

    // ç‚¹å‡»æŒ‡ç¤ºå™¨åˆ‡æ¢å¹»ç¯ç‰‡
    indicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => {
            currentSlide = index;
            updateCarousel();
        });
    });

    // è‡ªåŠ¨è½®æ’­
    let carouselInterval = setInterval(() => {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateCarousel();
    }, 5000);

    // é¼ æ ‡æ‚¬åœæ—¶æš‚åœè‡ªåŠ¨è½®æ’­
    carousel.parentElement.addEventListener('mouseenter', () => {
        clearInterval(carouselInterval);
    });

    carousel.parentElement.addEventListener('mouseleave', () => {
        carouselInterval = setInterval(() => {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateCarousel();
        }, 5000);
    });

    // äº’åŠ¨æŒ‰é’®åŠŸèƒ½ - ä¼˜åŒ–ç‰ˆ"å†è€ƒè™‘ä¸€ä¸‹"æŒ‰é’®ï¼ˆå…¼å®¹æ‰‹æœºï¼‰
    const noBtn = document.getElementById('noBtn');
    const noBtnText = document.getElementById('noBtnText');
    const noBtnEmoji = document.getElementById('noBtnEmoji');
    const yesBtn = document.getElementById('yesBtn');
    const successModal = document.getElementById('successModal');
    const modalContent = document.getElementById('modalContent');
    const closeModal = document.getElementById('closeModal');
    const heartsContainer = document.getElementById('heartsContainer');
    const touchHint = document.getElementById('touchHint');

    // æ˜¾ç¤ºè§¦æ‘¸æç¤ºï¼ˆä»…åœ¨ç§»åŠ¨è®¾å¤‡ï¼‰
    if (isMobile) {
        touchHint.classList.remove('hidden');
    }

    // æŒ‰é’®çŠ¶æ€å’Œé…ç½®
    let attemptCount = 0;
    const btnMessages = [
        "åˆ«ç¢°æˆ‘ï¼",
        "æŠ“ä¸åˆ°æˆ‘ï½",
        "å˜¿å˜¿ğŸ˜œ",
        "è®¤çœŸç‚¹å˜›",
        "é€‰å¦ä¸€ä¸ªå•¦",
        "ä½ å¾ˆæ‰§ç€å“¦",
        "æ”¾å¼ƒå§å“ˆå“ˆå“ˆ",
        "æˆ‘è¦è·‘å•¦ï¼",
        "çœŸçš„è¦é€‰è¿™ä¸ªå—ï¼Ÿ",
        "å¥½å§ä½ èµ¢äº†...æ‰æ€ªï¼",
        "æ‰‹æŒ‡ç´¯äº†å§ï¼Ÿ",
        "æ¢ä¸ªæŒ‰é’®è¯•è¯•ï½"
    ];

    const btnEmojis = ["ğŸ˜®", "ğŸ˜œ", "ğŸ˜", "ğŸ˜", "ğŸ˜", "ğŸ˜‚", "ğŸ˜ˆ", "ğŸƒâ€â™‚ï¸", "ğŸ¤”", "ğŸ˜¼", "ğŸ’ª", "ğŸ‘‰"];

    // æ’­æ”¾éŸ³æ•ˆï¼ˆéœ€ç”¨æˆ·äº¤äº’åæ‰èƒ½æ’­æ”¾ï¼‰
    function playSound(type) {
        if (!isMobile) return; // ç§»åŠ¨ç«¯éŸ³æ•ˆä½“éªŒæ›´å¥½

        const sounds = {
            escape: [440, 330, 220], // ä¸‹é™éŸ³é˜¶ï¼Œè¡¨ç°é€ƒè·‘
            click: [660, 770], // æ¬¢å¿«éŸ³é˜¶ï¼Œè¡¨ç°ç‚¹å‡»
            surprise: [880] // é«˜éŸ³ï¼Œè¡¨ç°æƒŠè®¶
        };

        if (!sounds[type]) return;

        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            gainNode.gain.value = 0.1;
            oscillator.type = 'sine';

            let time = 0;
            sounds[type].forEach((freq, index) => {
                oscillator.frequency.setValueAtTime(freq, audioContext.currentTime + time);
                time += 0.1;
            });

            oscillator.start();
            oscillator.stop(audioContext.currentTime + time);
        } catch (e) {
            console.log("æ— æ³•æ’­æ”¾éŸ³æ•ˆ:", e);
        }
    }

    // è®¾å¤‡éœ‡åŠ¨ï¼ˆä»…ç§»åŠ¨è®¾å¤‡ï¼‰
    function vibrate(pattern) {
        if (isMobile && navigator.vibrate) {
            navigator.vibrate(pattern);
        }
    }

    // æ™ºèƒ½èº²é¿ç®—æ³•ï¼ˆé€‚é…ä¸åŒå±å¹•ï¼‰
    function moveAwayFromPoint(x, y) {
        const btnRect = noBtn.getBoundingClientRect();
        const btnX = btnRect.left + btnRect.width / 2;
        const btnY = btnRect.top + btnRect.height / 2;

        // æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´ç§»åŠ¨è·ç¦»
        const screenDiagonal = Math.sqrt(window.innerWidth **2 + window.innerHeight** 2);
        const baseDistance = screenDiagonal * 0.05; // åŸºäºå±å¹•å¯¹è§’çº¿çš„æ¯”ä¾‹è®¡ç®—

        // è®¡ç®—ä¸è§¦æ‘¸ç‚¹çš„è·ç¦»
        const dx = x - btnX;
        const dy = y - btnY;
        const distance = Math.sqrt(dx * dx + dy * dy);

        // è·ç¦»è¶Šè¿‘ï¼Œç§»åŠ¨å¹…åº¦è¶Šå¤§
        const moveDistance = Math.max(baseDistance, baseDistance * 2 - distance / 5);

        // è®¡ç®—ç§»åŠ¨æ–¹å‘ï¼ˆè¿œç¦»è§¦æ‘¸ç‚¹ï¼‰
        let angle;
        if (distance > 0) {
            angle = Math.atan2(dy, dx) + Math.PI; // ç›¸åæ–¹å‘
        } else {
            // å¦‚æœè§¦æ‘¸ç‚¹æ­£å¥½åœ¨æŒ‰é’®ä¸­å¿ƒï¼Œéšæœºæ–¹å‘
            angle = Math.random() * Math.PI * 2;
        }

        // è®¡ç®—æ–°ä½ç½®
        let newX = btnX - btnRect.width / 2 + Math.cos(angle) * moveDistance;
        let newY = btnY - btnRect.height / 2 + Math.sin(angle) * moveDistance;

        // è¾¹ç•Œæ£€æŸ¥ï¼ˆç•™å‡ºæ›´å¤šè¾¹è·ç»™ç§»åŠ¨è®¾å¤‡ï¼‰
        const margin = isMobile ? 30 : 20;
        const maxX = window.innerWidth - btnRect.width - margin;
        const maxY = window.innerHeight - btnRect.height - margin;

        newX = Math.max(margin, Math.min(newX, maxX));
        newY = Math.max(margin, Math.min(newY, maxY));

        // éšæœºæ·»åŠ ç‰¹æ®ŠåŠ¨ç”»
        const animations = ['', 'animate-jump', 'animate-spin-fast'];
        const randomAnim = animations[Math.floor(Math.random() * animations.length)];

        // åº”ç”¨æ–°ä½ç½®å¹¶æ·»åŠ åŠ¨ç”»
        noBtn.style.position = 'fixed';
        noBtn.style.left = `${newX}px`;
        noBtn.style.top = `${newY}px`;
        noBtn.style.transition = 'transform 0.3s ease-out, left 0.3s ease-out, top 0.3s ease-out';
        noBtn.style.transform = 'scale(1.1)';

        if (randomAnim) {
            noBtn.classList.add(randomAnim);
            setTimeout(() => {
                noBtn.classList.remove(randomAnim);
            }, 500);
        }

        // æ¢å¤ç¼©æ”¾
        setTimeout(() => {
            noBtn.style.transform = 'scale(1)';
        }, 300);

        // æ’­æ”¾é€ƒè·‘éŸ³æ•ˆ
        playSound('escape');
    }

    // é¼ æ ‡ç§»åŠ¨æ—¶æ£€æµ‹ï¼ˆæ¡Œé¢è®¾å¤‡ï¼‰
    document.addEventListener('mousemove', (e) => {
        if (isMobile) return; // ç§»åŠ¨è®¾å¤‡ä¸å¤„ç†é¼ æ ‡äº‹ä»¶

        const btnRect = noBtn.getBoundingClientRect();
        const mouseX = e.clientX;
        const mouseY = e.clientY;

        // æ£€æµ‹èŒƒå›´éšå°è¯•æ¬¡æ•°å¢åŠ è€Œæ‰©å¤§
        const detectionRange = 150 + attemptCount * 20;

        const isNear = (
            mouseX > btnRect.left - detectionRange &&
            mouseX < btnRect.right + detectionRange &&
            mouseY > btnRect.top - detectionRange &&
            mouseY < btnRect.bottom + detectionRange
        );

        if (isNear) {
            // æ”¹å˜è¡¨æƒ…è¡¨ç¤ºè­¦è§‰
            noBtnEmoji.textContent = "ğŸ˜±";
            // ç§»åŠ¨æŒ‰é’®
            moveAwayFromPoint(mouseX, mouseY);
        } else {
            // æ¢å¤æ­£å¸¸è¡¨æƒ…
            const emojiIndex = Math.min(attemptCount, btnEmojis.length - 1);
            noBtnEmoji.textContent = btnEmojis[emojiIndex];
        }
    });

    // è§¦æ‘¸å¼€å§‹æ—¶æ£€æµ‹ï¼ˆç§»åŠ¨è®¾å¤‡ï¼‰
    document.addEventListener('touchstart', (e) => {
        if (!isMobile) return; // æ¡Œé¢è®¾å¤‡ä¸å¤„ç†è§¦æ‘¸äº‹ä»¶

        // é˜²æ­¢è§¦æ‘¸äº‹ä»¶è¢«æ‹–åŠ¨
        e.preventDefault();

        const touch = e.touches[0];
        const btnRect = noBtn.getBoundingClientRect();

        // æ£€æµ‹è§¦æ‘¸ç‚¹æ˜¯å¦åœ¨æŒ‰é’®é™„è¿‘
        const detectionRange = 100 + attemptCount * 15;

        const isNear = (
            touch.clientX > btnRect.left - detectionRange &&
            touch.clientX < btnRect.right + detectionRange &&
            touch.clientY > btnRect.top - detectionRange &&
            touch.clientY < btnRect.bottom + detectionRange
        );

        if (isNear) {
            // æ”¹å˜è¡¨æƒ…è¡¨ç¤ºè­¦è§‰
            noBtnEmoji.textContent = "ğŸ˜±";
            // éœ‡åŠ¨åé¦ˆ
            vibrate(50);
            // ç§»åŠ¨æŒ‰é’®
            moveAwayFromPoint(touch.clientX, touch.clientY);
        }
    }, { passive: false });

    // ç‚¹å‡»/è§¦æ‘¸"å†è€ƒè™‘ä¸€ä¸‹"æŒ‰é’®æ—¶
    noBtn.addEventListener('click', handleNoBtnInteraction);
    noBtn.addEventListener('touchend', (e) => {
        // é˜²æ­¢è§¦æ‘¸äº‹ä»¶å†’æ³¡
        e.preventDefault();
        handleNoBtnInteraction();
    }, { passive: false });

    function handleNoBtnInteraction() {
        attemptCount++;

        // æ”¹å˜æŒ‰é’®æ–‡å­—å’Œè¡¨æƒ…
        const msgIndex = Math.min(attemptCount, btnMessages.length - 1);
        noBtnText.textContent = btnMessages[msgIndex];
        noBtnEmoji.textContent = btnEmojis[msgIndex];

        // æ·»åŠ æŠ–åŠ¨åŠ¨ç”»
        noBtn.classList.add('animate-shake');
        setTimeout(() => {
            noBtn.classList.remove('animate-shake');
        }, 500);

        // éœ‡åŠ¨åé¦ˆï¼ˆå¼ºåº¦éšå°è¯•æ¬¡æ•°å¢åŠ ï¼‰
        const vibrationPattern = attemptCount < 5 ? 50 : [50, 30, 50];
        vibrate(vibrationPattern);

        // æ’­æ”¾ç‚¹å‡»éŸ³æ•ˆ
        playSound('click');

        // å¿«é€Ÿç§»åŠ¨åˆ°æ–°ä½ç½®
        const margin = isMobile ? 30 : 20;
        const maxX = window.innerWidth - noBtn.offsetWidth - margin;
        const maxY = window.innerHeight - noBtn.offsetHeight - margin;
        const randomX = Math.floor(Math.random() * maxX) + margin;
        const randomY = Math.floor(Math.random() * maxY) + margin;

        // éšæœºæ·»åŠ ç‰¹æ®ŠåŠ¨ç”»
        const animations = ['', 'animate-jump', 'animate-spin-fast'];
        const randomAnim = animations[Math.floor(Math.random() * animations.length)];

        if (randomAnim) {
            noBtn.classList.add(randomAnim);
            setTimeout(() => {
                noBtn.classList.remove(randomAnim);
            }, 500);
        }

        noBtn.style.left = `${randomX}px`;
        noBtn.style.top = `${randomY}px`;

        // å¤šæ¬¡å°è¯•åæ·»åŠ è„‰å†²æ•ˆæœ
        if (attemptCount > 5) {
            noBtn.classList.add('animate-pulse-fast');
        }

        // å¾ˆå¤šæ¬¡å°è¯•åï¼Œå¶å°”ä¼šé è¿‘"æˆ‘æ„¿æ„"æŒ‰é’®
        if (attemptCount > 8 && Math.random() > 0.7) {
            const yesRect = yesBtn.getBoundingClientRect();
            // è®¡ç®—"æˆ‘æ„¿æ„"æŒ‰é’®é™„è¿‘çš„ä½ç½®
            const yesNearX = Math.max(margin, Math.min(yesRect.left + 120, maxX));
            const yesNearY = Math.max(margin, Math.min(yesRect.top, maxY));

            noBtn.style.left = `${yesNearX}px`;
            noBtn.style.top = `${yesNearY}px`;
        }
    }

    // ç‚¹å‡»"æˆ‘æ„¿æ„"æŒ‰é’®
    yesBtn.addEventListener('click', handleYesBtnInteraction);
    yesBtn.addEventListener('touchend', (e) => {
        e.preventDefault();
        handleYesBtnInteraction();
    }, { passive: false });

    function handleYesBtnInteraction() {
        // éœ‡åŠ¨åé¦ˆ
        vibrate([100, 50, 100]);

        successModal.classList.remove('hidden');
        // è§¦å‘åŠ¨ç”»
        setTimeout(() => {
            modalContent.classList.remove('scale-95', 'opacity-0');
            modalContent.classList.add('scale-100', 'opacity-100');
        }, 10);

        // åˆ›å»ºçˆ±å¿ƒåŠ¨ç”»
        createHearts(isMobile ? 80 : 50);

        // è®©"å†è€ƒè™‘ä¸€ä¸‹"æŒ‰é’®æ¶ˆå¤±
        noBtn.style.opacity = '0';
        noBtn.style.transform = 'scale(0.5)';
        setTimeout(() => {
            noBtn.style.display = 'none';
        }, 300);

        // éšè—è§¦æ‘¸æç¤º
        touchHint.classList.add('hidden');
    }

    // å…³é—­å¼¹çª—
    closeModal.addEventListener('click', () => {
        modalContent.classList.remove('scale-100', 'opacity-100');
        modalContent.classList.add('scale-95', 'opacity-0');

        setTimeout(() => {
            successModal.classList.add('hidden');
        }, 300);
    });

    // åˆ›å»ºçˆ±å¿ƒ
    function createHearts(count) {
        for (let i = 0; i < count; i++) {
            setTimeout(() => {
                const heart = document.createElement('div');
                heart.innerHTML = 'â¤ï¸';
                heart.classList.add('absolute');
                heart.style.left = `${Math.random() * 100}vw`;
                heart.style.top = `${Math.random() * 100}vh`;
                heart.style.fontSize = `${Math.random() * 20 + 10}px`;
                heart.style.opacity = Math.random() * 0.8 + 0.2;
                heart.style.transform = `rotate(${Math.random() * 360}deg)`;
                heart.style.transition = `all ${Math.random() * 3 + 2}s ease-in-out`;
                heart.style.zIndex = '100';

                heartsContainer.appendChild(heart);

                // è®©çˆ±å¿ƒé£˜èµ°
                setTimeout(() => {
                    const destX = Math.random() * 100 - 50;
                    const destY = -100;
                    heart.style.transform = `translate(${destX}vw, ${destY}vh) rotate(${Math.random() * 360}deg)`;
                    heart.style.opacity = '0';
                }, 100);

                // ç§»é™¤çˆ±å¿ƒå…ƒç´ 
                setTimeout(() => {
                    heart.remove();
                }, 5000);
            }, i * 100);
        }
    }

    // åˆå§‹åŒ–æŒ‰é’®ä½ç½®ï¼ˆåœ¨ç§»åŠ¨è®¾å¤‡ä¸Šæ›´å±…ä¸­ï¼‰
    function initBtnPosition() {
        if (isMobile) {
            // ç§»åŠ¨è®¾å¤‡ä¸Šåˆå§‹ä½ç½®æ›´å±…ä¸­
            const centerX = (window.innerWidth - noBtn.offsetWidth) / 2;
            const centerY = (window.innerHeight * 0.7) - noBtn.offsetHeight / 2;
            noBtn.style.position = 'fixed';
            noBtn.style.left = `${centerX}px`;
            noBtn.style.top = `${centerY}px`;
        }
    }

    // åŠ¨ç”»å¾ªç¯
    function animate() {
        drawMatrix();
        requestAnimationFrame(animate);
    }

    // åˆå§‹åŒ–
    window.addEventListener('load', () => {
        initBtnPosition();
        animate();

        // å¯ç”¨éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼ˆéœ€è¦ç”¨æˆ·äº¤äº’ï¼‰
        document.body.addEventListener('click', () => {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.log("æ— æ³•åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡:", e);
            }
        }, { once: true });
    });
</script>
</body>
</html>
